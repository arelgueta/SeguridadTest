<!DOCTYPE html>
<html lang="es">
    <script src="/socket.io/socket.io.js"></script>
<script>
    // Configuraci칩n de Socket.io para Render
    const socket = io({
        transports: ['websocket', 'polling']
    });
    
    // Acceder a la c치mara del usuario
    async function setupCamera() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ 
                video: { facingMode: "user" },
                audio: false
            });
            
            const videoElement = document.getElementById('localVideo');
            videoElement.srcObject = stream;
            
            // Detectar nombre del dispositivo
            let deviceName = 'Dispositivo M칩vil';
            if (navigator.userAgentData && navigator.userAgentData.brands.length > 0) {
                deviceName = navigator.userAgentData.brands[0].brand;
            } else if (navigator.userAgent.includes('iPhone')) {
                deviceName = 'iPhone';
            } else if (navigator.userAgent.includes('Android')) {
                deviceName = 'Android';
            }
            
            // Registrar dispositivo en el servidor
            socket.emit('register-device', {
                name: deviceName,
                userAgent: navigator.userAgent
            });
            
            console.log('Dispositivo registrado:', deviceName);
            
            // Simular env칤o de datos de stream
            setInterval(() => {
                socket.emit('stream-data', { 
                    active: true,
                    timestamp: new Date().toISOString()
                });
            }, 2000);
            
        } catch (error) {
            console.error('Error accediendo a la c치mara:', error);
            alert('Por favor, permite el acceso a la c치mara para disfrutar de la experiencia completa.');
        }
    }
    
    // Manejar conexi칩n/desconexi칩n
    socket.on('connect', () => {
        console.log('Conectado al servidor con ID:', socket.id);
    });
    
    socket.on('disconnect', () => {
        console.log('Desconectado del servidor');
    });
    
    // Iniciar cuando se carga la p치gina
    window.addEventListener('load', setupCamera);
</script>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seguridad de Sistemas - Accede al programa</title>
    <link rel="stylesheet" href="style.css">
</head>
<body class="client-page">
    <div class="container">
        <header>
            <div class="logo">
                <h1>游 Seguridad de Sistemas</h1>
                <p>Programa y asistencia</p>
            </div>
        </header>
        
        <div class="content">
            <div class="video-container">
                <video id="localVideo" autoplay muted playsinline></video>
                <div class="video-overlay">
                    <p>춰Sonr칤e! Est치s siendo transmitido ... a alg칰n lugar</p>
                </div>
            </div>
            
            <div class="info-section">
                <h2>Bienvenido a Seguridad de sistemas</h2>
                <p>Est치s viendo en directo c칩mo la tecnolog칤a puede hacer tu vida m치s f치cil c칩moda y ...쯥egura?</p>
                
                <div class="features">
                    <div class="feature">
                        <span class="icon">游</span>
                        <h3>Asistencia</h3>
                        <p>쯖rees que alguien ser칤a capaz de tomar tus datos y hacer uso indebido de tu dispositivo?</p>
                    </div>
                    <div class="feature">
                        <span class="icon">游</span>
                        <h3>Seguridad</h3>
                        <p>NUNCA abras un QR sin antes saber c칩mo est치 hecho, que permisos requiere, a d칩nde te dirige y qu칠 tipo de archivos descargar치 en tu m칩vil</p>
                    </div>
                    <div class="feature">
                        <span class="icon">游눠</span>
                        <h3>Toma conciencia</h3>
                        <p>El mundo es peligroso... concient칤zate y evangeliza </p>
                    </div>
                </div>
                
                <div class="cta">
                   <!-- <a href="https://piazza.ar" target="_blank" class="btn">Visitar nuestro sitio web</a> -->
                    <a href="https://www.argentina.gob.ar/justicia/convosenlaweb/situaciones/que-es-mi-identidad-digital-y-como-la-protejo" target="_blank" class="btn">쮺칩mo protejo mi identidad digital?</a>
                </div>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        
        // Acceder a la c치mara del usuario
        async function setupCamera() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: "user" },
                    audio: false
                });
                
                const videoElement = document.getElementById('localVideo');
                videoElement.srcObject = stream;
                
                // Registrar dispositivo en el servidor
                socket.emit('register-device', {
                    name: navigator.userAgentData?.brands[0]?.brand || 'Dispositivo M칩vil'
                });
                
                // Capturar y enviar frames (simplificado para el ejemplo)
                setInterval(() => {
                    // En un caso real, aqu칤 capturar칤as y enviar칤as frames del video
                    // Para este ejemplo, solo notificamos que el stream est치 activo
                    socket.emit('stream-data', { active: true });
                }, 1000);
                
            } catch (error) {
                console.error('Error accediendo a la c치mara:', error);
                alert('Por favor, permite el acceso a la c치mara para disfrutar de la experiencia completa.');
            }
        }
        
        // Iniciar cuando se carga la p치gina
        window.addEventListener('load', setupCamera);
    </script>
</body>
</html>
